import numpy as np
import matplotlib.pyplot as plt
import time as time 

def g(x):
    return np.maximum(np.zeros_like(x), 1. - 100 * (x - 0.7)**2)


u = [0.01728646, 0.0344749,  0.0515653,  0.06855768, 0.08545203, 0.10224834,
 0.11894663, 0.13554689, 0.15204912, 0.16845332, 0.18475949, 0.20096763,
 0.21707775, 0.23308983, 0.24900388, 0.26481991, 0.28053791, 0.29615787,
 0.31167981, 0.32710372, 0.34242961, 0.35765746, 0.37278728, 0.38781908,
 0.40275285, 0.41758859, 0.4323263,  0.44696598, 0.46150763, 0.47595126,
 0.49029686, 0.50454442, 0.51869397, 0.53274548, 0.54669896, 0.56055442,
 0.57431185, 0.58797125, 0.60153262, 0.61499597, 0.62836128, 0.64162857
, 0.65479784, 0.66786907, 0.68084228, 0.69371745, 0.70649461, 0.71917373
, 0.73175483, 0.74423789, 0.75662294, 0.76890995, 0.78109894, 0.7931899
, 0.80518283, 0.81707774, 0.82887461, 0.84057346, 0.85217429, 0.86367709
, 0.87508186, 0.8863886, 0.89759732, 0.90870801, 0.91972067, 0.93063531
, 0.94145192, 0.95123197, 0.95743202, 0.95823905, 0.95252822, 0.93983662
, 0.92035277, 0.89492161, 0.86506508, 0.83301868, 0.80087425, 0.7686318
, 0.73629133, 0.70385282, 0.67131629, 0.63868174, 0.60594916, 0.57311855
, 0.54018992, 0.50716325, 0.47403857, 0.44081585, 0.40749511, 0.37407634
, 0.34055954, 0.30694471, 0.27323186, 0.23942098, 0.20551207, 0.17150513
, 0.13740016, 0.10319716, 0.06889614, 0.03449708]


#-- mesh
n = 100
x = np.linspace(0., 1., n + 2)

#-- contrainte
gvec = g(x[1:-1])

print("n =", n)

print("temps d'execution: ", 2426.0969, "s")

print("nombre d'iterations:", 11479451)
# print("solution:       ", u)

print("verif contrainte = ", -0.0)

#--- plot et export solution et contrainte sur l'intervalle [0, 1]
ufull = np.zeros_like(x)
ufull[1:-1] = u

plt.plot(x, ufull, "g-", label="solution")
plt.plot(x, g(x), "r-", label="obstacle")
# plt.title("methode d'uzawa'")
plt.legend()
plt.show()